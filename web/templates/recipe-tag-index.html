<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Page title</title>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Dosis">
    <link rel="stylesheet" href="../static/assets/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="../static/assets/fonts/awards/awards.css"/>
    <link rel="stylesheet" href="../static/assets/css/bootstrap-tokenfield.css"/>
    <link rel='stylesheet' href='https://sliptree.github.io/bootstrap-tokenfield/dist/css/tokenfield-typeahead.css'>
    <link rel="stylesheet" href="../static/assets/css/styles.css"/>
    <link rel="stylesheet" href="../static/assets/css/bootstrap.css"/>
    <link rel="icon" href="../static/assets/images/patterns/food.png">

    <!--[if lt IE 9]>
	    <script src="../static/assets/js/html5shiv.js"></script>
	<![endif]-->
</head>
<body>
<section id="rw-layout" class="rw-layout">

    <!--
    // ===================================^__^=================================== //
       Header
    // ===================================^__^=================================== //
    -->
    <div class="rw-section rw-header">
        <div class="rw-inner clearfix">
            <div class="grid-container">

                <div class="grid desk-8 mob-6 alpha clearfix">
                    {#                    <div class="logo-holder">#}
                    {#                        <img src="../static/assets/placeholder/logo.png" class="logo" alt=""/>#}
                    {#                    </div>#}
                    <nav id="the-main-menu" class="main-menu-nav menu-inline" data-breakpoint="1160">
                        <ul class="menu horizontal">
                            <li><a href="/">Home</a></li>
                            <li>
                                <a href="recipes.html">Recipes</a>
                                <ul class="sub-menu">
                                    <li><a href="single-recipe.html">Single recipe</a></li>
                                    <li><a href="submit-recipe.html">Submit recipe</a></li>
                                </ul>
                            </li>

                            <li>
                                <a href="elem-colors.html">More</a>
                                <ul class="sub-menu">
                                    <li><a href="elem-colors.html">Colors</a></li>
                                    <li><a href="elem-buttons.html">Buttons</a></li>
                                    <li><a href="elem-typography.html">Typography</a></li>
                                    <li><a href="elem-form.html">Form</a></li>
                                    <li><a href="elem-accordion.html">Accordion</a></li>
                                    <li><a href="elem-grid.html">Grid system</a></li>
                                </ul>
                            </li>
                        </ul>
                    </nav>
                </div>


            </div> <!-- .grid-container -->

        </div> <!-- .rw-inner -->
    </div> <!-- .rw-header -->

    <!--
    // ===================================^__^=================================== //
       Content
    // ===================================^__^=================================== //
    -->

    <div class="rw-section rw-container">
        <div class="rw-inner clearfix">

            <!-- Main content -->
            <div class="rw-column rw-content">

                <div class="rw-row">

                    <div class="keywords-filter-block">
                        <div class="filter-header clearfix">
                            <span class="title">Filter tags:</span>
                            <div class="filter-controls clearfix">
                                <span class="control block"><i class="fa fa-th-list"></i></span>
                                <span class="control inline active"><i class="fa fa-th"></i></span>
                            </div>
                        </div>


                        <div class="col-12 row rw-row">
                            <form class='form-horizontal col-12' role='form' id='find' method="POST"
                                  action={{ url_for("query") }}>
                                <input type="text" class="fullwidth filter-keywords" id="tokenin" name="search"
                                       placeholder="질병을 선택하세요"/>
                                <button class="btn btn-primary btn-md btn-block" type="button" data-toggle="modal"
                                        data-target="#modal" id="search">
                                    검색
                                </button>
                            </form>
                        </div>

                        <!-- Modal -->
                        <div id="modal" class="modal fade" tabindex="-1" role="dialog"
                             aria-labelledby="exampleModalCenterTitle" style="display: none;" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content" style="width:548px">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalCenterTitle">먹고 싶은 음식이 있으세요??</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">×</span>
                                        </button>
                                    </div>
                                    <div class="modal-body" style="height:200px; width:540px">

                                        <button type="button" class="btn btn-secondary btn-lg" id="ok"
                                                style="width:250px; height:150px">먹고싶은 음식이 있다
                                        </button>
                                        <button type="button" class="btn btn-primary btn-lg" id="no"
                                                style="width:250px; height:150px">먹고싶은 음식이 없다
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>


                        <div class="keywords-index-list">
                            <h4>질병명</h4>
                            <ul class="keywords">
                                {% for name in nameList %}
                                    {#                            <li><a href="#">구루병식</a></li>#}
                                    {#                            <li><a href="#">Acorn Squash <em>1</em></a></li>#}
                                    <li><a href="#"><img src="{{ disease[name] }}" width="150px"
                                                         height="150px" style="text-align: center"><br>{{ name }}</a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div> <!-- .recipe-index-list -->

                    </div> <!-- .rw-row -->

                </div> <!-- .rw-content -->

            </div> <!-- .rw-inner -->
        </div> <!-- .rw-container -->

        <!--
        // ===================================^__^=================================== //
           Footer
        // ===================================^__^=================================== //
        -->
        <div class="rw-section rw-footer">
            <div class="rw-inner clearfix">
                <div class="grid-container">

                    <div class="grid desk-6">
                        <div class="footer-totals clearfix">

                            <div class="total red clearfix">
                                <a href="recipes.php">
                                    <span class="mark value">13472</span>
                                    <span class="type">Recipes</span>
                                </a>
                            </div>

                            <div class="total green clearfix">
                                <a href="members.php">
                                    <span class="mark value">5649</span>
                                    <span class="type">Members</span>
                                </a>
                            </div>

                            <div class="total blue clearfix">
                                <a href="public-collections.php">
                                    <span class="mark value">728</span>
                                    <span class="type">Collections</span>
                                </a>
                            </div>

                        </div>
                    </div>

                    <div class="grid desk-6">
                        <div class="footer-menu">
                            <ul>
                                <li><a href="#">Terms</a></li>
                                <li><a href="#">Privacy</a></li>
                                <li><a href="#">Copyright</a></li>
                                <li><a href="#">About</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>
                    </div>

                </div>
                <a href="#rw-layout" class="footer-to-top" title="Go to top">
                    <i class="fa fa-chevron-up"></i>
                </a>
            </div>
        </div> <!-- .layout-footer -->
    </div>
</section><!-- .rw-layout -->

<!-- Javascript -->

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="../static/assets/js/bootstrap.min.js" type="text/javascript"></script>

<script src="../static/assets/js/min/smk-menu.min.js"></script>
<script src="../static/assets/js/rw-sidebar.js"></script>
<script src="../static/assets/js/min/jquery.qtip.min.js"></script>
<script src="../static/assets/js/min/smk-accordion.min.js"></script>
<script src="../static/assets/js/min/smk-visual-select.min.js"></script>
<script src="../static/assets/js/min/owl.carousel.min.js"></script>
<script src="../static/assets/js/bootstrap-tokenfield.js"></script>

<script type="text/javascript" src="../static/assets/js/scripts.js"></script>
<script src="../static/assets/js/jquery.cookie.js"></script>


<script type="text/javascript">

    $.cookie('a', undefined);
    $.cookie('foodName', undefined);
    $.cookie('done', undefined);
    $.cookie('insert', undefined);
    $.cookie('remove', undefined);


    function smk_theme_keyword_index_filter(elem) {
        console.log('elem filter : ' + elem); // TODO index_fileter0
        var value = $(elem).val().toLowerCase(),
            headings = $('.keywords-index-list h4');
        console.log('value index filter : ' + value); // TODO index_fileter
        // Hide or show headings
        value.length > 0 ? headings.hide() : headings.show();

        // Hide or show keywords
        $(".keywords-index-list li").each(function () {
            $(this).text().toLowerCase().search(value) > -1 ? $(this).removeClass('hide-keyword') : $(this).addClass('hide-keyword');
        });
    }

    // TODO 수정?!
    $("#tokenin").tokenfield();
    console.log($('#tokenin'));
    $('#tokenin').on('keyup', function () {
        console.log('token-input'); // TODO filter-keywords
        smk_theme_keyword_index_filter(document.getElementById("tokenin"));
    });

    $('#tokenin-tokenfield').on('keyup', function () {
        console.log('tokenin-tokenfield'); // TODO filter-keywords
        smk_theme_keyword_index_filter(document.getElementById("tokenin-tokenfield"));
    });


    function cauClick() {

        console.log(this.text);
        {#$("#tokenin").tokenfield();#}
        var temp = $("#tokenin").tokenfield('getTokensList')  // tokenlist 저장

        $("#tokenin").tokenfield('createToken', this.text);

        $("#tokenin").on('tokenfield:createtoken', function (event) {
            var existingTokens = $(this).tokenfield('getTokens');
            $.each(existingTokens, function (index, token) {
                if (token.value === event.attrs.value)
                    event.preventDefault();
            });
        });

       /* console.log($("#tokenin").tokenfield('getTokensList'));
        console.log($("#tokenin").tokenfield('getTokensList').split(", "));
        console.log($("#tokenin").tokenfield('getTokensList').split(", ").length);  */

        if($("#tokenin").tokenfield('getTokensList').split(", ").length > 2){
            alert('최대 두 개까지만 선택 가능')
            $("#tokenin").tokenfield('setTokens' , temp);
        }

        // TODO 함수 밖에서 호출
        {#console.log($('#tokenin'));#}
        {#$('#tokenin').on('keyup', function () {#}
        {#    console.log('token-input'); // TODO filter-keywords#}
        {#    smk_theme_keyword_index_filter(document.getElementById("tokenin"));#}
        //{#});#}
        {##}
        {#$('#tokenin-tokenfield').on('keyup', function () {#}
        {#    console.log('tokenin-tokenfield'); // TODO filter-keywords#}
        {#    smk_theme_keyword_index_filter(document.getElementById("tokenin-tokenfield"));#}
      //  {#});#}


        {#$('.token-input').addClass('fullwidth filter-keywords');#}
        console.log($("#tokenin"));

    }

    var recos = document.getElementsByClassName("keywords");
    for (var i = 0; i < recos.length; i++) {
        var reco = recos.item(i);
        var children = reco.getElementsByTagName("li");
        for (i = 0; i < children.length; i++) {
            {#console.log(children[i].getElementsByTagName("a")[0]);#}
            children[i].getElementsByTagName("a")[0].addEventListener("click", cauClick);
        }


    }
</script>

<script>
    $("#ok").on('click', function () {

        var form = document.getElementById("find");

        //input
        var input_id = document.createElement("input");

        input_id.setAttribute("type", "hidden");
        input_id.setAttribute("name", "choice");
        input_id.setAttribute("value", "1");

        form.appendChild(input_id);

        //폼전송

        form.submit();
    });

    $("#no").on('click', function () {

        var form = document.getElementById("find");

        //input
        var input_id = document.createElement("input");

        input_id.setAttribute("type", "hidden");
        input_id.setAttribute("name", "choice");
        input_id.setAttribute("value", "2");

        form.appendChild(input_id);

        //폼전송

        form.submit();
    });


</script>
</body>
</html>